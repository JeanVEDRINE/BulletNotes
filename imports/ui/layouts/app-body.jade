template(name='App_body')
  +HammerTouchArea(gestureMap=templateGestures)
    #container(class='{{wrapClasses}}')
      +momentum(plugin="fade")
        .mdl-layout.mdl-js-layout
          .mdl-layout.mdl-js-layout.mdl-layout--fixed-header(class="{{menuPin}}")
            header.mdl-layout__header.mdl-layout__header--waterfall
              .mdl-layout__header-row
                // Title
                span.mdl-layout-title

                  button#viewModeMenu.mdl-button.mdl-js-button.mdl-button--icon.mdl-js-ripple-effect.mdl-button--colored.mdl-button--raised(class="{{muteClass}}")
                    i.material-icons {{viewModeIcon}}
                  .mdl-tooltip.mdl-tooltip--large(for='viewModeMenu')
                    | View Mode

                  .js-edit-note.title-page
                    if focusedNote
                      .title-wrapper(contenteditable='true') {{{focusedNoteTitle}}}
                    else if searchTerm
                      .title-wrapper(style='opacity:.5;cursor:default') Searching: {{ searchTerm }}
                    else
                      .title-wrapper(style='opacity:.5;cursor:default') {{_ 'layouts.appBody.home'}}
                  div.mdl-menu.mdl-menu--bottom-left.mdl-js-menu.mdl-js-ripple-effect(for='viewModeMenu')
                    a.mdl-menu__item.noteMode
                      label.mdl-button.mdl-js-button.mdl-button--icon(for='waterfall-exp')
                        i.material-icons fiber_manual_record
                      | {{_ 'layouts.appBody.noteMode'}}
                    a.mdl-menu__item.calendarMode
                      label.mdl-button.mdl-js-button.mdl-button--icon(for='waterfall-exp')
                        i.material-icons date_range
                      | {{_ 'layouts.appBody.calendarMode'}}
                    a.mdl-menu__item.kanbanMode
                      label.mdl-button.mdl-js-button.mdl-button--icon(for='waterfall-exp')
                        i.material-icons view_column
                      | {{_ 'layouts.appBody.kanbanMode'}}
                .mdl-layout-spacer
                .searchIcon.mdl-textfield.mdl-js-textfield.mdl-textfield--expandable.mdl-textfield--floating-label.mdl-textfield--align-right
                  label.mdl-button.mdl-js-button.mdl-button--icon(for='waterfall-exp')
                    i.material-icons search
                  .mdl-textfield__expandable-holder
                    input#waterfall-exp.mdl-textfield__input.search(placeholder="{{_ 'layouts.appBody.search'}}...")

              // Tabs
              //if focusedNote
              .mdl-layout__tab-bar
                +breadcrumbs (noteArgs focusedNoteId)
            .mdl-layout__drawer
              +menu
            main.mdl-layout__content
              if ready
                +Template.dynamic(template=main)
                +footer
                #scrollToTopWrap
                  button#scrollToTop.hasTooltip.mdl-button.mdl-js-button.mdl-button--fab.mdl-js-ripple-effect.mdl-button--accent
                    i.material-icons arrow_upward
                .mdl-tooltip.mdl-tooltip--large.mdl-tooltip--top(for='scrollToTop')
                  | Scroll To Top
              else
                +App_loading
      +unless connected
        .notifications
          .notification
            span.glyphicon.glyphicon-refresh.glyphicon-spin
            .meta
              .title-notification
                | {{_ 'layouts.appBody.tryingToConnect'}}
              .description
                | {{_ 'layouts.appBody.connectionIssue'}}
      if dev
        .notifications.devWarning
          .notification
            span.glyphicon.glyphicon-warning-sign
            .meta
              .title-notification
                | {{_ 'layouts.appBody.devWarning'}}
              .description
                | {{_ 'layouts.appBody.devWarningBody'}}
      else
        .notifications.betaWarning
          .notification
            span.glyphicon.glyphicon-warning-sign
            .meta
              .title-notification
                | {{_ 'layouts.appBody.devWarning'}}
              .description
                | {{{_ 'layouts.appBody.betaWarningBody'}}}
  #snackbar.mdl-js-snackbar.mdl-snackbar
    .mdl-snackbar__text
    button.mdl-snackbar__action(type='button')
  style.
    body {
      background: {{theme}};
    }
